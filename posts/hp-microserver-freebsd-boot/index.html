<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>HP Microserver Gen 8 - FreeBSD Bootloader | jeakob</title><link rel=stylesheet href=/blog/css/main.min.85f001f5c882de523b5193062681a63b7a6b8550bd0279e1802c7f5f18553435.css integrity="sha256-hfAB9ciC3lI7UZMGJoGmO3prhVC9AnnhgCx/XxhVNDU=" crossorigin=anonymous></head><body><header><h1>jeakob
<a href=https://github.com/jeakob rel=me class=social aria-label=GitHub><svg width="1em" height="1em" viewBox="-2 -2 24 24"><path fill="currentcolor" d="M18.88 1.099C18.147.366 17.265.0 16.233.0H3.746C2.714.0 1.832.366 1.099 1.099.366 1.832.0 2.714.0 3.746v12.487c0 1.032.366 1.914 1.099 2.647.733.733 1.615 1.099 2.647 1.099H6.66c.19.0.333-.007.429-.02a.504.504.0 00.286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555.0 01-.904-.091 2.026 2.026.0 01-.872-.39 1.651 1.651.0 01-.572-.8l-.13-.3a3.25 3.25.0 00-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956.0 01-.17-.156.723.723.0 01-.117-.182c-.026-.061-.004-.111.065-.15.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1.0 01.631.677c.2.355.44.626.722.813.282.186.566.28.852.28.286.0.533-.022.742-.065a2.59 2.59.0 00.585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907.0 01-1.333-.234 5.314 5.314.0 01-1.223-.507 3.5 3.5.0 01-1.047-.872c-.277-.347-.505-.802-.683-1.365-.177-.564-.266-1.215-.266-1.952.0-1.049.342-1.942 1.027-2.68-.32-.788-.29-1.673.091-2.652.252-.079.625-.02 1.119.175.494.195.856.362 1.086.5.23.14.414.257.553.352a9.233 9.233.0 012.497-.338c.859.0 1.691.113 2.498.338l.494-.312a6.997 6.997.0 011.197-.572c.46-.174.81-.221 1.054-.143.39.98.424 1.864.103 2.653.685.737 1.028 1.63 1.028 2.68.0.737-.089 1.39-.267 1.957-.177.568-.407 1.023-.689 1.366a3.65 3.65.0 01-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9.0 01-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36.0 00.208.189c.096.034.18.056.254.064.074.01.18.013.318.013h2.914c1.032.0 1.914-.366 2.647-1.099.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/></svg></a></h1><nav><ul class=top-menu><li><a href=/blog/>home</a></li><li><a aria-current=true class=ancestor href=/blog/posts/>posts</a></li><li><a href=/blog/tags/>tags</a></li></ul></nav></header><main><h1>HP Microserver Gen 8 - FreeBSD Bootloader</h1><time datetime=2025-12-19T21:08:00+00:00>December 19, 2025</time><h2 id=the-problem>The Problem</h2><p>The HP MicroServer Gen8 has limited and inflexible boot options. In many configurations, it cannot reliably boot an operating system directly from certain internal drives (most commonly SSDs installed in the optical bay or via internal ports). As a result, the system may fail to start even though the OS is installed correctly and the hardware is otherwise functional.</p><h2 id=the-solution>The Solution</h2><p>This guide explains how to install FreeBSD on external boot media that the HP MicroServer Gen8 can load at startup. Once loaded, the FreeBSD bootloader is used to select a configured internal drive—typically an SSD, which then boots the operating system of your choice.</p><blockquote><p><strong>Tip:</strong> It’s best to unplug all hard drives first.</p></blockquote><blockquote><p><strong>Note:</strong> I recommend installing FreeBSD on the internal USB or microSD card.</p></blockquote><figure class=image><img style=aspect-ratio:807/499 src=/blog/1_FreeBSD_image.png width=1200 height=499></figure><figure class=image><img style=aspect-ratio:802/653 src=/blog/2_FreeBSD_image.png width=1200 height=653></figure><figure class=image><img style=aspect-ratio:354/245 src=/blog/3_FreeBSD_image.png width=354 height=245></figure><p>After installing FreeBSD but before restarting, drop to a shell when offered to. Assuming your new boot key is <code>da1</code>, clear whatever partitions you have first, then format it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>gpart destroy -F da1
</span></span><span style=display:flex><span>gpart create -s GPT da1
</span></span></code></pre></div><h3 id=install-the-bootloader>Install the bootloader:</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>gpart bootcode -b /boot/boot0 da1
</span></span></code></pre></div><p>Assuming all four LFF drive bays are populated, configure the bootloader to use the fifth drive (the SSD) and set it as the default boot option:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>boot0cfg -Bv -o setdrv -d 0x84 -s <span style=color:#ae81ff>5</span> da1
</span></span></code></pre></div><p><code>0x84</code> refers to the fifth BIOS drive. Use these if you have others:</p><ul><li><code>0x80</code> – for just the SSD (though I suppose that’s redundant)</li><li><code>0x81</code> – one other drive installed</li><li><code>0x82</code> – two other drives installed</li><li><code>0x83</code> – three other drives isntalled</li><li><code>0x84</code> – all four other drives installed</li></ul><p>The flags are:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>-B         install FreeBSD<span style=color:#960050;background-color:#1e0010>&#39;</span>s boot0 manager
</span></span><span style=display:flex><span>-v         like my blog, be verbose
</span></span><span style=display:flex><span>-o setdrv  refer to the disk by BIOS drive number
</span></span><span style=display:flex><span>-d         BIOS drive number
</span></span><span style=display:flex><span>-s <span style=color:#ae81ff>5</span>       boot from second disk; in this <span style=color:#66d9ef>case</span> the SSD 
</span></span></code></pre></div><p>There are several ways to approach this, but this method has been reliable for me for years.</p><p>The main drawback is that if you add additional internal drives later, you’ll need to update the boot loader with the new address. If you forget, you can always boot from the FreeBSD installer and drop to a shell to update it again. In practice, though, most people already have all the drive bays populated, which is largely the point of these small systems.</p><p>If your MicroServer still refuses to boot—as one of mine did—try connecting the bootable USB stick to one of the external USB 2.0 ports instead. One of my units may have a flaky internal port, but this workaround worked fine on another system here, as well as on the unit I keep at my dad’s place, which I’ve just realised I forgot to include in my homelab post.</p><h3 id=boot-screenshot>Boot Screenshot:</h3><figure class=image><img style=aspect-ratio:1047/661 src=/blog/4_FreeBSD_image.png width=1200 height=661></figure><h4 id=after-a-couple-of-seconds-you-will-see-grub>After a couple of seconds, you will see GRUB:</h4><figure class=image><img style=aspect-ratio:1046/650 src=/blog/FreeBSD_image.png width=1200 height=650></figure><div><h2>tags:</h2><ul class=taxonomy-list><li class=taxonomy><a href=/blog/tags/hp/>hp</a></li><li class=taxonomy><a href=/blog/tags/microserver/>microserver</a></li><li class=taxonomy><a href=/blog/tags/freebsd/>freebsd</a></li></ul></div></main><footer><p class=terminal>jeakob@blog $ <span class=blink>_</span></p></footer></body></html>